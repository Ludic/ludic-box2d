{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 84269d591ffdcc665f3b","webpack:///./src/box2d/b2d.js","webpack:///external \"ludic\"","webpack:///./src/rube/RubeLoader.js","webpack:///./src/rube/RubeScene.js","webpack:///./src/box2d/debugDraw.js","webpack:///./src/box2d/world.js","webpack:///./src/rube/rubeAssetLoader.js","webpack:///./src/rube/rubeAsset.js","webpack:///./src/rube/rubeImageAsset.js","webpack:///external \"box2d\"","webpack:///./src/main.js"],"names":["_Box2D","window","Box2D","Object","prototype","hasOwnProperty","property","RubeLoader","bodyJso","world","console","log","bd","b2BodyDef","type","set_type","b2_dynamicBody","b2_kinematicBody","b2_staticBody","active","set_active","set_angle","angle","set_angularVelocity","angularVelocity","set_angularDamping","angularDamping","set_awake","awake","set_bullet","bullet","set_fixedRotation","fixedRotation","set_linearDamping","linearDamping","allowSleep","set_allowSleep","linearVelocity","set_linearVelocity","parseVec","b2Vec2","position","set_position","isNaN","parseFloat","gravityScale","isFinite","set_gravityScale","body","CreateBody","fixtures","md","b2MassData","set_mass","set_center","set_I","SetMassData","k","length","fixtureJso","loadFixtureFromRUBE","name","customProperties","parseCustomProperties","props","types","forEach","prop","undefined","value","fd","b2FixtureDef","set_density","density","set_friction","friction","set_restitution","restitution","set_isSensor","sensor","filter","b2Filter","set_categoryBits","set_maskBits","set_groupIndex","set_filter","shape","b2CircleShape","radius","circle","center","set_m_radius","set_m_p","set_shape","fixture","CreateFixture","data","json","push","verts","_verts","v","polygon","vertices","x","y","createPolygonShape","chain","createChainShape","val","obj","jointJso","loadedBodies","bodyA","bodyB","joint","jd","b2RevoluteJointDef","set_bodyA","set_bodyB","set_collideConnected","collideConnected","set_localAnchorA","anchorA","set_localAnchorB","anchorB","set_enableLimit","enableLimit","set_enableMotor","enableMotor","set_lowerAngle","lowerLimit","set_maxMotorTorque","maxMotorTorque","set_motorSpeed","motorSpeed","set_referenceAngle","refAngle","set_upperAngle","upperLimit","CreateJoint","b2DistanceJointDef","set_dampingRatio","dampingRatio","set_frequencyHz","frequency","set_length","b2RopeJointDef","set_maxLength","maxLength","b2MotorJointDef","set_linearOffset","set_angularOffset","set_maxForce","maxForce","set_maxTorque","maxTorque","set_correctionFactor","correctionFactor","b2PrismaticJointDef","set_localAxisA","localAxisA","set_lowerTranslation","set_maxMotorForce","maxMotorForce","set_upperTranslation","b2WheelJointDef","springDampingRatio","springFrequency","b2FrictionJointDef","b2WeldJointDef","newObj","Array","i","makeClone","worldJso","loadSceneIntoWorld","success","scene","loadBodyFromRUBE","bodies","loadedJoints","loadJointFromRUBE","joints","_success","gravity","SetV","b2World","b","m_bodyList","m_next","f","m_fixtureList","j","m_jointList","propertyType","propertyName","valueToMatch","item","defaultValue","closedLoop","b2ChainShape","buffer","allocate","ALLOC_STACK","offset","setValue","get_x","get_y","ptr_wrapped","wrapPointer","CreateLoop","CreateChain","b2PolygonShape","Set","numVerts","Math","random","sin","cos","RubeScene","sceneJson","_json","key","opts","_isFinished","DebugDraw","canvas","context","getContext","debugDraw","getCanvasDebugDraw","utils","using","e_shapeBit","e_jointBit","e_aabbBit","e_pairBit","e_centerOfMassBit","color","col","b2Color","red","get_r","green","get_g","blue","get_b","colStr","fillStyle","strokeStyle","vert1","vert2","vert1V","vert2V","beginPath","moveTo","lineTo","stroke","vertexCount","fill","tmpI","vert","closePath","axis","centerV","axisV","arc","PI","Util","copyVec2","op_add","scaledVec2","transform","trans","b2Transform","pos","get_p","rot","get_q","save","translate","scale","rotate","GetAngle","lineWidth","drawAxes","restore","ctx","arr","JSDraw","self","DrawSegment","setColorFromDebugDrawCallback","saveContext","drawSegment","DrawPolygon","drawPolygon","DrawSolidPolygon","DrawCircle","dummyAxis","drawCircle","DrawSolidCircle","DrawTransform","drawTransform","d","World","arguments","enableStep","_contactListeners","_contactListener","JSContactListener","BeginContact","onContact","bind","EndContact","PreSolve","PostSolve","SetContactListener","override","DrawDebugData","begin","contactPtr","listener","contactObject","bodyInvolvedInContact","className","entityData","constructor","callback","l","addAlso","cl","ContactListener","registerBodyContactListener","contact","b2Contact","GetFixtureA","GetBody","GetFixtureB","delta","a","stepWorld","Step","destroy","RubeAssetLoader","url","options","error","RubeAsset","warn","_promises","_loadJSON","promise","Promise","resolve","reject","_resolve","_reject","xobj","XMLHttpRequest","overrideMimeType","open","onreadystatechange","onload","send","readyState","status","JSON","parse","responseText","am","image","loadImages","images","img","loadResource","file","baseUrl","RubeImageAsset","fixRubeUrl","Image","src","imageInfo","components","split","splice","join","path","corners","p"],"mappings":"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","file":"ludic-box2d.umd.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"ludic\"), require(\"box2d\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"ludic\", \"box2d\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ludic-box2d\"] = factory(require(\"ludic\"), require(\"box2d\"));\n\telse\n\t\troot[\"ludic-box2d\"] = factory(root[\"ludic\"], root[\"box2d\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_9__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 84269d591ffdcc665f3b","// this is a shim for the box2d lib\nimport Box2D from 'box2d'\nlet _Box2D = window.Box2D || Box2D.Box2D || Box2D; /* || ()=>{console.warn(\"Unknown config of Box2D. Failed to load library\");return {};}; */\nexport {_Box2D as default};\n\n\n\n// WEBPACK FOOTER //\n// ./src/box2d/b2d.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ludic\"\n// module id = 1\n// module chunks = 0","import Box2D from '../box2d/b2d';\nimport RubeScene from './RubeScene';\n\nObject.prototype.hasOwnProperty = function(property) {\n  return typeof(this[property]) !== 'undefined'\n};\n\nclass RubeLoader {\n\n  constructor(){\n\n  }\n\n  loadBodyFromRUBE(bodyJso, world) {\n    if ( ! bodyJso.hasOwnProperty('type') ) {\n      console.log(\"Body does not have a 'type' property\");\n      return null;\n    }\n\n    var bd = new Box2D.b2BodyDef();\n    if ( bodyJso.type == 2 )\n      bd.set_type(Box2D.b2_dynamicBody);\n    else if ( bodyJso.type == 1 )\n      bd.set_type(Box2D.b2_kinematicBody);\n    else\n      bd.set_type(Box2D.b2_staticBody);\n\n    if(bodyJso.active === false){\n      bd.set_active(false);\n    }\n    bd.set_angle(bodyJso.angle || 0);\n    bd.set_angularVelocity(bodyJso.angularVelocity || 0);\n    bd.set_angularDamping(bodyJso.angularDamping || 0);\n    bd.set_awake(bodyJso.awake || false);\n    bd.set_bullet(bodyJso.bullet || false);\n    bd.set_fixedRotation(bodyJso.fixedRotation || false);\n    bd.set_linearDamping(bodyJso.linearDamping || false);\n    if(!bodyJso.allowSleep){\n      bd.set_allowSleep(false);\n    }\n\n    if ( bodyJso.hasOwnProperty('linearVelocity') && bodyJso.linearVelocity instanceof Object )\n      bd.set_linearVelocity(this.parseVec( bodyJso.linearVelocity ));\n    else\n      bd.set_linearVelocity(new Box2D.b2Vec2(0,0));\n\n    if ( bodyJso.hasOwnProperty('position') && bodyJso.position instanceof Object )\n      bd.set_position(this.parseVec(bodyJso.position ));\n    else\n      bd.set_position(new Box2D.b2Vec2(0,0));\n\n    if (bodyJso.hasOwnProperty('gravityScale') && !isNaN(parseFloat(bodyJso.gravityScale)) && isFinite(bodyJso.gravityScale)) {\n      bd.set_gravityScale(bodyJso.gravityScale);\n    } else {\n      bd.set_gravityScale(1);\n    }\n\n    var body = world.CreateBody(bd);\n    body.fixtures = [];\n\n    var md = new Box2D.b2MassData();\n    md.set_mass(bodyJso['massData-mass'] || 0);\n    if ( bodyJso.hasOwnProperty('massData-center') && bodyJso['massData-center'] instanceof Object )\n      md.set_center(this.parseVec(bodyJso['massData-center']));\n    else\n      md.set_center(new Box2D.b2Vec2(0,0));\n\n    md.set_I(bodyJso['massData-I'] || 0);\n\n    body.SetMassData(md);\n\n    if(bodyJso.hasOwnProperty('fixture')){\n      for (var k = 0; k < bodyJso['fixture'].length; k++) {\n        var fixtureJso = bodyJso['fixture'][k];\n        this.loadFixtureFromRUBE(body, fixtureJso);\n      }\n    }\n    if(bodyJso.hasOwnProperty('name')){\n      body.name = bodyJso.name;\n    }\n    if(bodyJso.hasOwnProperty('customProperties')){\n      body.customProperties = bodyJso.customProperties;\n      this.parseCustomProperties(body);\n    }\n    return body;\n  }\n\n  parseCustomProperties(body){\n    body.props = body.props || {};\n    var types = ['string','vec2','color','float','int','bool'];\n    body.customProperties.forEach( (prop)=>{\n      // var data = {};\n      // data[prop.name] = prop.string || prop.vec2 || prop.color || null;\n      // if(data[prop.name]===null){\n      //   data[prop.name] = prop.float!==undefined?prop.float:null;\n      // }\n      // if(data[prop.name]===null){\n      //   data[prop.name] = prop.int!==undefined?prop.int:null;\n      // }\n      // if(data[prop.name]===null){\n      //   data[prop.name] = prop.bool!==undefined?prop.bool:null;\n      // }\n      // body.props.push(data);\n\n      types.forEach( (type)=>{\n        if(prop[type]!==undefined){\n          prop.value = prop[type];\n          prop.type = type;\n        }\n      });\n\n      body.props[prop.name] = {\n        type:prop.type,\n        value:prop.value\n      };\n    });\n  }\n\n  loadFixtureFromRUBE(body, fixtureJso) {\n    var fd = new Box2D.b2FixtureDef();\n    fd.set_density(fixtureJso.density || 0);\n    fd.set_friction(fixtureJso.friction || 0);\n    fd.set_restitution(fixtureJso.restitution || 0);\n    fd.set_isSensor(fixtureJso.sensor || 0);\n\n    var filter = new Box2D.b2Filter();\n\n    filter.set_categoryBits(fixtureJso['filter-categoryBits'] || 1);\n    filter.set_maskBits(fixtureJso['filter-maskBits'] || 65535);\n    filter.set_groupIndex(fixtureJso['filter-groupIndex'] || 0);\n\n    fd.set_filter(filter);\n\n    if (fixtureJso.hasOwnProperty('circle')) {\n\n      var shape = new Box2D.b2CircleShape();\n      var radius = fixtureJso.circle.radius || 0;\n      var center = this.parseVec(fixtureJso.circle.center);\n\n\n      shape.set_m_radius(radius);\n      shape.set_m_p(center);\n\n      fd.set_shape(shape);\n\n      var fixture = body.CreateFixture(fd);\n      if ( fixtureJso.name )\n        fixture.name = fixtureJso.name;\n\n      // body.shapeType = 'circle';\n      // body.radius = radius;\n      // body.center = center;\n      var data = {\n        type:'circle',\n        radius:radius,\n        center:center,\n        json:fixtureJso\n      }\n      body.fixtures.push(data);\n    }\n    else if (fixtureJso.hasOwnProperty('polygon')) {\n\n      var verts = [];\n      var _verts = [];\n      for (var v = 0; v < fixtureJso.polygon.vertices.x.length; v++) {\n        verts.push( new Box2D.b2Vec2( fixtureJso.polygon.vertices.x[v], fixtureJso.polygon.vertices.y[v] ) );\n        _verts.push({x:fixtureJso.polygon.vertices.x[v], y:fixtureJso.polygon.vertices.y[v]});\n      }\n\n\n      var shape = this.createPolygonShape(verts);\n\n      fd.set_shape(shape);\n\n\n      var fixture = body.CreateFixture(fd);\n\n      if ( fixture && fixtureJso.name )\n        fixture.name = fixtureJso.name;\n\n      // body.shapeType = 'polygon';\n      // body.verts = verts;\n      var data = {\n        type:'polygon',\n        verts:_verts,\n        json:fixtureJso\n      }\n      body.fixtures.push(data);\n    }\n    else if (fixtureJso.hasOwnProperty('chain')) {\n\n      var verts = [];\n      var _verts = [];\n      for (var v = 0; v < fixtureJso.chain.vertices.x.length; v++){\n        verts.push(new Box2D.b2Vec2(fixtureJso.chain.vertices.x[v], fixtureJso.chain.vertices.y[v]));\n        _verts.push({x:fixtureJso.chain.vertices.x[v], y:fixtureJso.chain.vertices.y[v]});\n      }\n\n      shape = this.createChainShape(verts);\n      fd.set_shape(shape);\n\n      var fixture = body.CreateFixture(fd);\n      if ( fixtureJso.name )\n        fixture.name = fixtureJso.name;\n\n      // body.shapeType = 'chain';\n      // body.verts = verts;\n      var data = {\n        type:'chain',\n        verts:_verts,\n        json:fixtureJso\n      }\n      body.fixtures.push(data);\n    }\n    else {\n      console.log(\"Could not find shape type for fixture\");\n    }\n  }\n\n  getVectorValue(val) {\n    if ( val instanceof Object )\n      return val;\n    else\n      return { x:0, y:0 };\n  }\n\n  parseVec(obj) {\n    if (obj && obj instanceof Object)\n      return new Box2D.b2Vec2(obj.x || 0, obj.y || 0);\n    else\n      return new Box2D.b2Vec2(0,0);\n  }\n\n\n\n  loadJointFromRUBE(jointJso, world, loadedBodies)\n  {\n    if ( ! jointJso.hasOwnProperty('type') ) {\n      console.log(\"Joint does not have a 'type' property\");\n      return null;\n    }\n    if ( jointJso.bodyA >= loadedBodies.length ) {\n      console.log(\"Index for bodyA is invalid: \" + jointJso.bodyA );\n      return null;\n    }\n    if ( jointJso.bodyB >= loadedBodies.length ) {\n      console.log(\"Index for bodyB is invalid: \" + jointJso.bodyB );\n      return null;\n    }\n\n    var joint = null;\n\n    if ( jointJso.type == \"revolute\" ) {\n      var jd = new Box2D.b2RevoluteJointDef();\n      jd.set_bodyA(loadedBodies[jointJso.bodyA]);\n      jd.set_bodyB(loadedBodies[jointJso.bodyB]);\n      jd.set_collideConnected(jointJso.collideConnected || false);\n      jd.set_localAnchorA(this.parseVec(jointJso.anchorA));\n      jd.set_localAnchorB(this.parseVec(jointJso.anchorB));\n      jd.set_enableLimit(jointJso.enableLimit || false);\n      jd.set_enableMotor(jointJso.enableMotor || false);\n      jd.set_lowerAngle(jointJso.lowerLimit || 0);\n      jd.set_maxMotorTorque(jointJso.maxMotorTorque || 0);\n      jd.set_motorSpeed(jointJso.motorSpeed || 0);\n      jd.set_referenceAngle(jointJso.refAngle || 0);\n      jd.set_upperAngle(jointJso.upperLimit || 0);\n\n      joint = world.CreateJoint(jd);\n    }\n    else if ( jointJso.type == \"distance\") {\n      var jd = new Box2D.b2DistanceJointDef();\n      jd.set_bodyA(loadedBodies[jointJso.bodyA]);\n      jd.set_bodyB(loadedBodies[jointJso.bodyB]);\n      jd.set_collideConnected(jointJso.collideConnected || false);\n      jd.set_localAnchorA(this.parseVec(jointJso.anchorA));\n      jd.set_localAnchorB(this.parseVec(jointJso.anchorB));\n      jd.set_dampingRatio(jointJso.dampingRatio || 0);\n      jd.set_frequencyHz(jointJso.frequency || 0);\n      jd.set_length(jointJso.length || 0);\n\n      joint = world.CreateJoint(jd);\n    }\n    else if ( jointJso.type == \"rope\") {\n      var jd = new Box2D.b2RopeJointDef();\n\n      jd.set_bodyA(loadedBodies[jointJso.bodyA]);\n      jd.set_bodyB(loadedBodies[jointJso.bodyB]);\n      jd.set_collideConnected(jointJso.collideConnected || false);\n      jd.set_localAnchorA(this.parseVec(jointJso.anchorA));\n      jd.set_localAnchorB(this.parseVec(jointJso.anchorB));\n      jd.set_maxLength(jointJso.maxLength || 0);\n      joint = world.CreateJoint(jd);\n    }\n    else if ( jointJso.type == \"motor\") {\n      if (Box2D.b2MotorJointDef){\n        var jd = new Box2D.b2MotorJointDef();\n\n        jd.set_bodyA(loadedBodies[jointJso.bodyA]);\n        jd.set_bodyB(loadedBodies[jointJso.bodyB]);\n        jd.set_collideConnected(jointJso.collideConnected || false);\n\n        jd.set_linearOffset(this.parseVec(jointJso.anchorA));\n        jd.set_angularOffset(jointJso.refAngle || 0);\n        jd.set_maxForce(jointJso.maxForce || 0);\n        jd.set_maxTorque(jointJso.maxTorque || 0);\n        jd.set_correctionFactor(jointJso.correctionFactor || 0);\n\n        joint = world.CreateJoint(jd);\n      } else {\n        console.log(\"This version of box2d doesn't support motor joints\");\n      }\n    }\n    else if ( jointJso.type == \"prismatic\" ) {\n      var jd = new Box2D.b2PrismaticJointDef();\n      jd.set_bodyA(loadedBodies[jointJso.bodyA]);\n      jd.set_bodyB(loadedBodies[jointJso.bodyB]);\n      jd.set_collideConnected(jointJso.collideConnected || false);\n      jd.set_localAnchorA(this.parseVec(jointJso.anchorA));\n      jd.set_localAnchorB(this.parseVec(jointJso.anchorB));\n      jd.set_enableLimit(jointJso.enableLimit || false);\n      jd.set_enableMotor(jointJso.enableMotor || false);\n      jd.set_localAxisA(this.parseVec(jointJso.localAxisA));\n      jd.set_lowerTranslation(jointJso.lowerLimit || 0);\n      jd.set_maxMotorForce(jointJso.maxMotorForce || 0);\n      jd.set_motorSpeed(jointJso.motorSpeed || 0);\n      jd.set_referenceAngle(jointJso.refAngle || 0);\n      jd.set_upperTranslation(jointJso.upperLimit || 0);\n      joint = world.CreateJoint(jd);\n    }\n    else if ( jointJso.type == \"wheel\" ) {\n\n      var jd = new Box2D.b2WheelJointDef();\n      jd.set_bodyA(loadedBodies[jointJso.bodyA]);\n      jd.set_bodyB(loadedBodies[jointJso.bodyB]);\n      jd.set_collideConnected(jointJso.collideConnected || false);\n      jd.set_localAnchorA(this.parseVec(jointJso.anchorA));\n      jd.set_localAnchorB(this.parseVec(jointJso.anchorB));\n      jd.set_enableMotor(jointJso.enableMotor || false);\n      jd.set_localAxisA(this.parseVec(jointJso.localAxisA));\n      jd.set_maxMotorTorque(jointJso.maxMotorTorque || 0);\n      jd.set_motorSpeed(jointJso.motorSpeed || 0);\n      jd.set_dampingRatio(jointJso.springDampingRatio || 0);\n      jd.set_frequencyHz(jointJso.springFrequency || 0);\n      joint = world.CreateJoint(jd);\n\n    }\n    else if ( jointJso.type == \"friction\" ) {\n      var jd = new Box2D.b2FrictionJointDef();\n\n      jd.set_bodyA(loadedBodies[jointJso.bodyA]);\n      jd.set_bodyB(loadedBodies[jointJso.bodyB]);\n      jd.set_collideConnected(jointJso.collideConnected || false);\n      jd.set_localAnchorA(this.parseVec(jointJso.anchorA));\n      jd.set_localAnchorB(this.parseVec(jointJso.anchorB));\n      jd.set_maxForce(jointJso.maxForce || 0);\n      jd.set_maxTorque(jointJso.maxTorque || 0);\n      joint = world.CreateJoint(jd);\n    }\n    else if ( jointJso.type == \"weld\" ) {\n      var jd = new Box2D.b2WeldJointDef();\n\n      jd.set_bodyA(loadedBodies[jointJso.bodyA]);\n      jd.set_bodyB(loadedBodies[jointJso.bodyB]);\n      jd.set_collideConnected(jointJso.collideConnected || false);\n      jd.set_localAnchorA(this.parseVec(jointJso.anchorA));\n      jd.set_localAnchorB(this.parseVec(jointJso.anchorB));\n      jd.set_referenceAngle(jointJso.refAngle || 0);\n      jd.set_dampingRatio(jointJso.dampingRatio || 0);\n      jd.set_frequencyHz(jointJso.frequency || 0);\n      joint = world.CreateJoint(jd);\n    }\n    else {\n      console.log(\"Unsupported joint type: \" + jointJso.type);\n      console.log(jointJso);\n    }\n    if ( joint && jointJso.name )\n      joint.name = jointJso.name;\n    return joint;\n  }\n\n  makeClone(obj) {\n    var newObj = (obj instanceof Array) ? [] : {};\n    for (var i in obj) {\n      if (obj[i] && typeof obj[i] == \"object\")\n        newObj[i] = makeClone(obj[i]);\n      else\n        newObj[i] = obj[i];\n    }\n    return newObj;\n  };\n\n\n  //mainly just a convenience for the testbed - uses global 'world' variable\n  loadSceneFromRUBE(worldJso) {\n    return loadSceneIntoWorld(worldJso, world);\n  }\n\n  //load the scene into an already existing world variable\n  loadSceneIntoWorld(worldJso, world) {\n    var success = true;\n    var scene = new RubeScene(worldJso, world);\n\n    var loadedBodies = [];\n    if ( worldJso.hasOwnProperty('body') ) {\n      for (var i = 0; i < worldJso.body.length; i++) {\n        var bodyJso = worldJso.body[i];\n        var body = this.loadBodyFromRUBE(bodyJso, world);\n        if ( body ) {\n          loadedBodies.push( body );\n        } else {\n          success = false;\n        }\n      }\n    }\n    scene.bodies = loadedBodies;\n\n    var loadedJoints = [];\n    if ( worldJso.hasOwnProperty('joint') ) {\n      for (var i = 0; i < worldJso.joint.length; i++) {\n        var jointJso = worldJso.joint[i];\n        var joint = this.loadJointFromRUBE(jointJso, world, loadedBodies);\n        if ( joint )\n          loadedJoints.push( joint );\n        //else\n        //    success = false;\n      }\n    }\n    scene.joints = loadedJoints;\n    scene._success = success;\n\n\n    return scene;\n  }\n\n  //create a world variable and return it if loading succeeds\n  loadWorldFromRUBE(worldJso) {\n    var gravity = new Box2D.b2Vec2(0,0);\n    if ( worldJso.hasOwnProperty('gravity') && worldJso.gravity instanceof Object )\n      gravity.SetV( worldJso.gravity );\n    var world = new Box2D.b2World( gravity );\n    if ( ! loadSceneIntoWorld(worldJso, world) )\n      return false;\n    return world;\n  }\n\n  getNamedBodies(world, name) {\n    var bodies = [];\n    for (b = world.m_bodyList; b; b = b.m_next) {\n      if ( b.name == name )\n        bodies.push(b);\n    }\n    return bodies;\n  }\n\n  getNamedFixtures(world, name) {\n    var fixtures = [];\n    for (var b = world.m_bodyList; b; b = b.m_next) {\n      for (var f = b.m_fixtureList; f; f = f.m_next) {\n        if ( f.name == name )\n          fixtures.push(f);\n      }\n    }\n    return fixtures;\n  }\n\n  getNamedJoints(world, name) {\n    var joints = [];\n    for (var j = world.m_jointList; j; j = j.m_next) {\n      if ( j.name == name )\n        joints.push(j);\n    }\n    return joints;\n  }\n\n  //custom properties\n  getBodiesByCustomProperty(world, propertyType, propertyName, valueToMatch) {\n    var bodies = [];\n    for (var b = world.m_bodyList; b; b = b.m_next) {\n      if ( ! b.hasOwnProperty('customProperties') )\n        continue;\n      for (var i = 0; i < b.customProperties.length; i++) {\n        if ( ! b.customProperties[i].hasOwnProperty(\"name\") )\n          continue;\n        if ( ! b.customProperties[i].hasOwnProperty(propertyType) )\n          continue;\n        if ( b.customProperties[i].name == propertyName &&\n          b.customProperties[i][propertyType] == valueToMatch)\n          bodies.push(b);\n      }\n    }\n    return bodies;\n  }\n\n  hasCustomProperty(item, propertyType, propertyName) {\n    if ( !item.hasOwnProperty('customProperties') )\n      return false;\n    for (var i = 0; i < item.customProperties.length; i++) {\n      if ( ! item.customProperties[i].hasOwnProperty(\"name\") )\n        continue;\n      if ( ! item.customProperties[i].hasOwnProperty(propertyType) )\n        continue;\n      return true;\n    }\n    return false;\n  }\n\n  getCustomProperty(item, propertyType, propertyName, defaultValue) {\n    if ( !item.hasOwnProperty('customProperties') )\n      return defaultValue;\n    for (var i = 0; i < item.customProperties.length; i++) {\n      if ( ! item.customProperties[i].hasOwnProperty(\"name\") )\n        continue;\n      if ( ! item.customProperties[i].hasOwnProperty(propertyType) )\n        continue;\n      if ( item.customProperties[i].name == propertyName )\n        return item.customProperties[i][propertyType];\n    }\n    return defaultValue;\n  }\n\n  // http://stackoverflow.com/questions/12792486/emscripten-bindings-how-to-create-an-accessible-c-c-array-from-javascript\n  createChainShape(vertices, closedLoop) {\n      var shape = new Box2D.b2ChainShape();\n      var buffer = Box2D.allocate(vertices.length * 8, 'float', Box2D.ALLOC_STACK);\n      var offset = 0;\n      for (var i=0;i<vertices.length;i++) {\n          Box2D.setValue(buffer+(offset), vertices[i].get_x(), 'float'); // x\n          Box2D.setValue(buffer+(offset+4), vertices[i].get_y(), 'float'); // y\n          offset += 8;\n      }\n      var ptr_wrapped = Box2D.wrapPointer(buffer, Box2D.b2Vec2);\n      if ( closedLoop )\n          shape.CreateLoop(ptr_wrapped, vertices.length);\n      else\n          shape.CreateChain(ptr_wrapped, vertices.length);\n      return shape;\n  }\n\n  createPolygonShape(vertices) {\n      var shape = new Box2D.b2PolygonShape();\n      var buffer = Box2D.allocate(vertices.length * 8, 'float', Box2D.ALLOC_STACK);\n      var offset = 0;\n      for (var i=0;i<vertices.length;i++) {\n          Box2D.setValue(buffer+(offset), vertices[i].get_x(), 'float'); // x\n          Box2D.setValue(buffer+(offset+4), vertices[i].get_y(), 'float'); // y\n          offset += 8;\n      }\n      var ptr_wrapped = Box2D.wrapPointer(buffer, Box2D.b2Vec2);\n      shape.Set(ptr_wrapped, vertices.length);\n      return shape;\n  }\n\n  createRandomPolygonShape(radius) {\n      var numVerts = 3.5 + Math.random() * 5;\n      numVerts = numVerts | 0;\n      var verts = [];\n      for (var i = 0; i < numVerts; i++) {\n          var angle = i / numVerts * 360.0 * 0.0174532925199432957;\n          verts.push( new b2Vec2( radius * Math.sin(angle), radius * -Math.cos(angle) ) );\n      }\n      return this.createPolygonShape(verts);\n  }\n}\n\nexport default new RubeLoader();\n\n\n\n// WEBPACK FOOTER //\n// ./src/rube/RubeLoader.js","class RubeScene {\n  constructor(sceneJson, world) {\n    this._json = sceneJson;\n    this.world = world;\n  }\n\n  destroy(){\n    // this.world = null;\n    // this.bodies = null;\n    // this.joints = null;\n    // this.objects = null;\n    for(let key in this){\n      this[key] = null;\n    }\n  }\n\n  finish(opts){\n    this.data = opts;\n    this._isFinished = true;\n  }\n}\n\nexport default RubeScene;\n\n\n\n// WEBPACK FOOTER //\n// ./src/rube/RubeScene.js","import Box2D from './b2d';\nimport {utils} from 'ludic';\n\nclass DebugDraw {\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.context = canvas.getContext('2d');\n    this.debugDraw = this.getCanvasDebugDraw();\n    utils.using(this,this.debugDraw,true);\n  }\n\n  static newDebugger(canvas) {\n    var d = new DebugDraw(canvas);\n    return d.debugDraw;\n  }\n\n  initBits(){\n    this.e_shapeBit = 0x0001;\n    this.e_jointBit = 0x0002;\n    this.e_aabbBit = 0x0004;\n    this.e_pairBit = 0x0008;\n    this.e_centerOfMassBit = 0x0010;\n  }\n\n  setColorFromDebugDrawCallback(color) {\n      var col = Box2D.wrapPointer(color, Box2D.b2Color);\n      var red = (col.get_r() * 255)|0;\n      var green = (col.get_g() * 255)|0;\n      var blue = (col.get_b() * 255)|0;\n      var colStr = red+\",\"+green+\",\"+blue;\n      this.context.fillStyle = \"rgba(\"+colStr+\",0.5)\";\n      this.context.strokeStyle = \"rgb(\"+colStr+\")\";\n  }\n\n  drawSegment(vert1, vert2) {\n      var vert1V = Box2D.wrapPointer(vert1, Box2D.b2Vec2);\n      var vert2V = Box2D.wrapPointer(vert2, Box2D.b2Vec2);\n      this.context.beginPath();\n      this.context.moveTo(vert1V.get_x(),vert1V.get_y());\n      this.context.lineTo(vert2V.get_x(),vert2V.get_y());\n      this.context.stroke();\n  }\n\n  drawPolygon(vertices, vertexCount, fill) {\n      this.context.beginPath();\n      for(var tmpI=0;tmpI<vertexCount;tmpI++) {\n          var vert = Box2D.wrapPointer(vertices+(tmpI*8), Box2D.b2Vec2);\n          if ( tmpI == 0 )\n              this.context.moveTo(vert.get_x(),vert.get_y());\n          else\n              this.context.lineTo(vert.get_x(),vert.get_y());\n      }\n      this.context.closePath();\n      if (fill)\n          this.context.fill();\n      this.context.stroke();\n  }\n\n  drawCircle(center, radius, axis, fill) {\n      var centerV = Box2D.wrapPointer(center, Box2D.b2Vec2);\n      var axisV = Box2D.wrapPointer(axis, Box2D.b2Vec2);\n\n      this.context.beginPath();\n      this.context.arc(centerV.get_x(),centerV.get_y(), radius, 0, 2 * Math.PI, false);\n      if (fill)\n          this.context.fill();\n      this.context.stroke();\n\n      if (fill) {\n          //render axis marker\n          var vert2V = Util.copyVec2(centerV);\n          vert2V.op_add( Util.scaledVec2(axisV, radius) );\n          this.context.beginPath();\n          this.context.moveTo(centerV.get_x(),centerV.get_y());\n          this.context.lineTo(vert2V.get_x(),vert2V.get_y());\n          this.context.stroke();\n      }\n  }\n\n  drawTransform(transform) {\n      var trans = Box2D.wrapPointer(transform,Box2D.b2Transform);\n      var pos = trans.get_p();\n      var rot = trans.get_q();\n\n      this.context.save();\n      this.context.translate(pos.get_x(), pos.get_y());\n      this.context.scale(0.5,0.5);\n      this.context.rotate(rot.GetAngle());\n      this.context.lineWidth *= 2;\n      this.drawAxes(context);\n      this.context.restore();\n  }\n\n  // solid polygon: rgba(127, 127, 76, 0.498039215686275)\n  // solid polygon: rgba(127, 127, 76, 0.498039215686275)\n  // solid circle: rgba(229, 178, 178, 0.498039215686275)\n\n  saveContext(type){\n    var ctx = this.context;\n    this.obj = this.obj || {};\n\n    if(!this.obj.hasOwnProperty(ctx.fillStyle)){\n      var arr = this.obj[ctx.fillStyle] = this.obj[ctx.fillStyle] || [];\n      arr.push(type);\n\n      // console.log(this.obj);\n    }\n\n  }\n\n  getCanvasDebugDraw() {\n      var debugDraw = new Box2D.JSDraw();\n      var self = this;\n      debugDraw.DrawSegment = function(vert1, vert2, color) {\n          self.setColorFromDebugDrawCallback(color);\n          self.saveContext('draw segment');\n          console.log('draw seg');\n          self.drawSegment(vert1, vert2);\n      };\n\n      debugDraw.DrawPolygon = function(vertices, vertexCount, color) {\n        console.log('draw poly');\n          self.setColorFromDebugDrawCallback(color);\n          self.saveContext('draw polygon');\n          self.drawPolygon(vertices, vertexCount, false);\n      };\n\n      debugDraw.DrawSolidPolygon = function(vertices, vertexCount, color) {\n        console.log('draw solid poly');\n          self.setColorFromDebugDrawCallback(color);\n          self.saveContext('draw solid polygon');\n          self.drawPolygon(vertices, vertexCount, true);\n      };\n\n      debugDraw.DrawCircle = function(center, radius, color) {\n          self.setColorFromDebugDrawCallback(color);\n          self.saveContext('draw circle');\n          var dummyAxis = Box2D.b2Vec2(0,0);\n          self.drawCircle(center, radius, dummyAxis, false);\n      };\n\n      debugDraw.DrawSolidCircle = function(center, radius, axis, color) {\n          self.setColorFromDebugDrawCallback(color);\n          self.saveContext('draw solid circle');\n          self.drawCircle(center, radius, axis, true);\n      };\n\n      debugDraw.DrawTransform = function(transform) {\n          self.drawTransform(transform);\n      };\n\n      return debugDraw;\n  }\n\n  getDebugDraw(){\n    return this.debugDraw;\n  }\n\n  // TODO: implement better bit flag management\n  // setShapeBit(bit){\n  //   if(bit){\n  //\n  //   }\n  // }\n\n  destroy(){\n    this.debugDraw = null;\n  }\n}\n\nDebugDraw.e_shapeBit = 0x0001;\nDebugDraw.e_jointBit = 0x0002;\nDebugDraw.e_aabbBit = 0x0004;\nDebugDraw.e_pairBit = 0x0008;\nDebugDraw.e_centerOfMassBit = 0x0010;\n\nexport default DebugDraw;\n\n\n\n// WEBPACK FOOTER //\n// ./src/box2d/debugDraw.js","import Box2D from './b2d';\nimport {utils} from 'ludic';\n\n// var canvasOffset = {\n//   x: 0,\n//   y: 0\n// };\n\nclass World {\n\n  constructor(b2Vec2, y) {\n    if(!(b2Vec2 instanceof Box2D.b2Vec2) && typeof b2Vec2 === 'number' && arguments.length === 2){\n      // read arg[0] as x coord\n      b2Vec2 = new Box2D.b2Vec2(b2Vec2, y)\n    } else if(arguments.length === 0){\n      b2Vec2 = new Box2D.b2Vec2(0,0)\n    } else {\n      throw \"Improper arguments for World\"\n    }\n\n    this.world = new Box2D.b2World(b2Vec2);\n    utils.using(this, this.world)\n    this.enableStep();\n\n    // contact stuff\n    this._contactListeners = [];\n    this._contactListener = new Box2D.JSContactListener();\n\n    this._contactListener.BeginContact = this.onContact(true).bind(this);\n    this._contactListener.EndContact = this.onContact(false).bind(this);\n    this._contactListener.PreSolve = function() {};\n    this._contactListener.PostSolve = function() {};\n\n    this.world.SetContactListener(this._contactListener);\n  }\n\n  drawDebug(override=false){\n    this.world.DrawDebugData();\n  }\n\n  onContact(begin){\n    return function(contactPtr){\n      var listener;\n      for(var i=0;i<this._contactListeners.length;i++){\n        listener = this._contactListeners[i];\n        var contactObject = this.bodyInvolvedInContact(listener.body, contactPtr);\n\n        if(contactObject){\n          if(listener.className) {\n            if( contactObject.entityData.constructor.name === listener.className){\n              listener.callback(begin, contactObject);\n            }\n          } else {\n            listener.callback(begin, contactObject);\n          }\n        } else {\n          continue;\n        }\n      }\n    }\n  }\n\n  // onBeginContact(contactPtr){\n  //   var listener;\n  //   for(var i=0;i<this._contactListeners.length;i++){\n  //     listener = this._contactListeners[i];\n  //\n  //     var contactObject = this.bodyInvolvedInContact(listener.body, contactPtr);\n  //\n  //     if(contactObject){\n  //       // console.log(\"player.onBeginContact\");\n  //\n  //       if(listener.className) {\n  //         if( contactObject.entityData.constructor.name === listener.className){\n  //           listener.callback(true, contactObject);\n  //         }\n  //       } else {\n  //         listener.callback(true, contactObject);\n  //       }\n  //\n  //     } else {\n  //       continue;\n  //     }\n  //   }\n  // }\n  //\n  // onEndContact(contactPtr){\n  //\n  // }\n\n  registerBodyContactListener(l){\n    this._contactListeners.push(l);\n  }\n\n  newBodyContactListener(body, className, callback, addAlso){\n    var cl = new ContactListener(body, className, callback);\n\n    if(addAlso){\n      this.registerBodyContactListener(cl);\n    }\n\n    return cl;\n  }\n\n  bodyInvolvedInContact(body, contactPtr){\n    var contact = Box2D.wrapPointer(contactPtr, Box2D.b2Contact);\n    var bodyA = contact.GetFixtureA().GetBody();\n    var bodyB = contact.GetFixtureB().GetBody();\n    if(bodyA == body){\n      return bodyB;\n    } else if(bodyB == body){\n      return bodyA;\n    } else {\n      return false;\n    }\n  }\n\n  step(delta=0,a=3,b=2){\n    if(this.stepWorld){\n      this.world.Step(delta, a, b);\n    }\n  }\n\n  enableStep(){\n    this.stepWorld = true;\n  }\n\n  disableStep(){\n    this.stepWorld = false;\n  }\n\n  destroy(){\n    Box2D.destroy(this.world);\n  }\n\n}\n\nclass ContactListener {\n  constructor(body,className,callback) {\n    if(typeof className === 'function' ){\n      callback = className;\n      className = false;\n    }\n\n    this.body = body;\n    this.className = className;\n    this.callback = callback;\n  }\n}\n\nexport default World;\n\n\n\n// WEBPACK FOOTER //\n// ./src/box2d/world.js","import RubeAsset from './rubeAsset'\nimport RubeImageAsset from './rubeImageAsset'\n\nclass RubeAssetLoader {\n  constructor() {\n\n  }\n\n  load(name, url, type, options){\n    switch (type) {\n      case 'rube':\n        return new RubeAsset(name, url, type, options);\n        break;\n      case 'rubeImage':\n        return new RubeImageAsset(name, url, type, options);\n        break;\n      default:\n        console.error('RubeAssetLoader: unknown asset type:: ', arguments);\n        return null;\n    }\n  }\n}\n\nexport default new RubeAssetLoader();\n\n\n\n// WEBPACK FOOTER //\n// ./src/rube/rubeAssetLoader.js","import {Asset} from 'ludic';\nimport RubeLoader from './RubeLoader';\n\nclass RubeAsset extends Asset {\n  constructor(name, url, type, options) {\n    super(name,url,type,options);\n    this.world = this.options.world;\n    if(!this.world){\n      console.warn('RubeAsset has no world.', this);\n    }\n\n    this._promises = [];\n    this._loadJSON();\n  }\n\n  _loadRube(){\n\n  }\n\n  _loadJSON() {\n    this.promise = new Promise((resolve,reject)=>{\n      this._resolve = resolve;\n      this._reject = reject;\n      this.xobj = new XMLHttpRequest();\n      this.xobj.overrideMimeType(\"application/json\");\n      this.xobj.open('GET', this.url, true);\n      this.xobj.onreadystatechange = this.onload(resolve,reject);\n    });\n  }\n\n  load(){\n    this.xobj.send(null);\n  }\n\n  onload(resolve,reject){\n    return () => {\n      if (this.xobj.readyState == 4 && this.xobj.status == \"200\") {\n        var sceneJson = JSON.parse(this.xobj.responseText);\n        this.data = RubeLoader.loadSceneIntoWorld(sceneJson, this.world);\n        if(this.data._success){\n          resolve(this);\n        } else {\n          reject(this);\n        }\n      }\n    };\n  }\n\n  onAssetResolve(am){\n    if(this.data._json.image){\n      this.loadImages(this.data._json.image, am);\n    }\n  }\n\n  loadImages(images, am){\n    var img;\n    for(var i=0; i<images.length; i++){\n      img = images[i];\n      am.loadResource(img.name,img.file,'rubeImage',{img:img,scene:this.data});\n    }\n  }\n\n  destroy(){\n    this.world = null;\n    this.promise = null;\n    this._promises = null;\n    this.xobj = null;\n    this.data.destroy();\n    this.data = null;\n    this.options = null;\n  }\n}\n\nexport default RubeAsset;\n\n\n\n// WEBPACK FOOTER //\n// ./src/rube/rubeAsset.js","import {Asset} from 'ludic';\n\n\n// TODO: get this from some config\nvar baseUrl = 'src';\n\nclass RubeImageAsset extends Asset {\n  constructor(name, url, type, options) {\n    super(name, url, type || 'image', options);\n\n    this.img = options.img;\n    this.scene = options.scene;\n\n    // do some string manipulation on url\n    this.url = this.fixRubeUrl(this.url);\n\n    this.data = new Image();\n    this.promise = new Promise((resolve,reject)=>{\n      this.data.onload = this.onload(resolve,reject);\n    });\n\n  }\n\n  load(){\n    // this.calculateSize();\n    this.data.src = this.url;\n  }\n\n  onload(resolve,reject){\n    return () => {\n      resolve(this);\n    };\n  }\n\n  onAssetResolve(am){\n    this.scene.bodies[this.img.body].imageInfo = this.img;\n  }\n\n  fixRubeUrl(url){\n    var components = url.split('/');\n    components.splice(0,1,baseUrl);\n    url = components.join('/');\n    this.options.path = url;\n    return url;\n  }\n\n  calculateSize(){\n    // var verts = this.img.glVertexPointer;\n    var verts = [];\n    for(var i=0; i<this.img.corners.x.length; i++){\n      var p = {\n        x:this.img.corners.x[i],\n        y:this.img.corners.y[i]\n      };\n      verts.push(p);\n    }\n    this.img.verts = verts;\n\n    var a = verts[1].x - verts[0].x;\n    var b = verts[1].y - verts[0].y;\n\n    // console.log(a,b);\n    // var width = Math.sqrt( Math.pow() );\n  }\n\n  destroy(){\n    super.destroy();\n    this.img = null;\n    this.scene = null;\n  }\n}\n\nexport default RubeImageAsset;\n\n\n\n// WEBPACK FOOTER //\n// ./src/rube/rubeImageAsset.js","module.exports = __WEBPACK_EXTERNAL_MODULE_9__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"box2d\"\n// module id = 9\n// module chunks = 0","// box2d\nexport {default as Box2D, default as default} from './box2d/b2d' // this is a shim\n\n// debug draw\nexport {default as DebugDraw} from './box2d/debugDraw'\n\n// world\nexport {default as World} from './box2d/world'\n\n// rube\nexport {default as RubeLoader} from './rube/RubeLoader'\nexport {default as RubeScene} from './rube/RubeScene'\nexport {default as RubeAssetLoader} from './rube/rubeAssetLoader'\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}